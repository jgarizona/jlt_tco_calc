<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JLT Mobile Computers ‚Äî TCO Calculator 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;500;600;700;800&family=Barlow:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #0d0f12;
    --bg2: #13161b;
    --bg3: #1a1e26;
    --border: #2a2f3d;
    --border-bright: #3a4055;
    --amber: #f5a623;
    --amber-dim: #c47d10;
    --amber-glow: rgba(245,166,35,0.12);
    --blue: #4a90d9;
    --blue-dim: rgba(74,144,217,0.15);
    --green: #27ae60;
    --red: #e74c3c;
    --text: #dce3f0;
    --text-dim: #7a8399;
    --text-muted: #4a5268;
    --rugged: #e67e22;
    --semi: #3498db;
    --consumer: #e74c3c;
    --jlt: #27ae60;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Barlow', sans-serif;
    font-weight: 400;
    min-height: 100vh;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    background: var(--bg2);
    border-bottom: 2px solid var(--amber);
    padding: 0 2rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 24px rgba(0,0,0,0.4);
  }
  .logo {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 800;
    font-size: 1.3rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--amber);
  }
  .logo span { color: var(--text); font-weight: 400; }
  .header-badge {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    color: var(--text-dim);
    background: var(--bg3);
    border: 1px solid var(--border);
    padding: 0.25rem 0.6rem;
    border-radius: 2px;
    letter-spacing: 0.05em;
  }

  /* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
  .page { max-width: 1440px; margin: 0 auto; padding: 2rem; }
  .subtitle {
    text-align: center;
    color: var(--text-dim);
    font-size: 0.85rem;
    margin-bottom: 2rem;
    letter-spacing: 0.04em;
  }
  .subtitle strong { color: var(--amber); }

  .legend-row {
    display: flex; gap: 1.5rem; justify-content: center; margin-bottom: 2.5rem;
  }
  .legend-item {
    display: flex; align-items: center; gap: 0.5rem;
    font-size: 0.8rem; color: var(--text-dim);
  }
  .legend-dot {
    width: 12px; height: 12px; border-radius: 1px;
  }
  .ld-amber { background: var(--amber); }
  .ld-blue { background: var(--blue); }

  /* ‚îÄ‚îÄ SECTION CARD ‚îÄ‚îÄ */
  .section {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 4px;
    margin-bottom: 1.5rem;
    overflow: hidden;
  }
  .section-header {
    background: var(--bg3);
    border-bottom: 1px solid var(--border);
    padding: 0.75rem 1.25rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    user-select: none;
  }
  .section-header:hover { background: #1f2530; }
  .section-icon { font-size: 1rem; }
  .section-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.95rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--text);
    flex: 1;
  }
  .section-chevron {
    color: var(--text-dim); font-size: 0.7rem; transition: transform 0.2s;
  }
  .section-chevron.open { transform: rotate(180deg); }
  .section-body { padding: 1.25rem; }
  .section-body.collapsed { display: none; }

  /* ‚îÄ‚îÄ COLUMN HEADERS ‚îÄ‚îÄ */
  .col-headers {
    display: grid;
    grid-template-columns: 1fr repeat(4, 180px);
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    padding: 0 0.25rem;
  }
  .col-hdr {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    text-align: center;
    padding: 0.4rem;
    border-radius: 2px;
  }
  .col-hdr.rugged  { color: var(--rugged);  background: rgba(230,126,34,0.1);  border-bottom: 2px solid var(--rugged); }
  .col-hdr.semi    { color: var(--semi);    background: rgba(52,152,219,0.1);  border-bottom: 2px solid var(--semi); }
  .col-hdr.consumer{ color: var(--consumer);background: rgba(231,76,60,0.1);   border-bottom: 2px solid var(--consumer); }
  .col-hdr.jlt     { color: var(--jlt);     background: rgba(39,174,96,0.1);   border-bottom: 2px solid var(--jlt); }

  /* ‚îÄ‚îÄ INPUT ROWS ‚îÄ‚îÄ */
  .input-row {
    display: grid;
    grid-template-columns: 1fr repeat(4, 180px);
    gap: 0.5rem;
    align-items: center;
    padding: 0.3rem 0.25rem;
    border-radius: 2px;
    transition: background 0.15s;
  }
  .input-row:hover { background: rgba(255,255,255,0.02); }
  .input-row.separator { border-top: 1px solid var(--border); margin-top: 0.5rem; padding-top: 0.75rem; }
  .row-label {
    font-size: 0.82rem;
    color: var(--text-dim);
    line-height: 1.3;
    padding-right: 1rem;
  }
  .row-label.note {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-style: italic;
    padding: 0.25rem 0;
    grid-column: 1 / -1;
  }

  /* ‚îÄ‚îÄ INPUTS ‚îÄ‚îÄ */
  input[type="number"], input[type="text"], select {
    width: 100%;
    background: var(--amber-glow);
    border: 1px solid var(--amber-dim);
    color: var(--amber);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.82rem;
    padding: 0.4rem 0.6rem;
    border-radius: 2px;
    text-align: right;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  input[type="number"]:focus, input[type="text"]:focus, select:focus {
    border-color: var(--amber);
    box-shadow: 0 0 0 2px rgba(245,166,35,0.2);
  }
  select { text-align: left; cursor: pointer; }
  select option { background: var(--bg2); color: var(--text); }

  /* Single-column inputs (shared) */
  .shared-inputs {
    display: grid;
    grid-template-columns: 1fr 240px;
    gap: 0.5rem;
    align-items: center;
  }
  .shared-inputs .input-row {
    grid-template-columns: 1fr 240px;
  }

  /* ‚îÄ‚îÄ CALC DISPLAY ‚îÄ‚îÄ */
  .calc-val {
    background: var(--blue-dim);
    border: 1px solid rgba(74,144,217,0.2);
    color: var(--blue);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.82rem;
    padding: 0.4rem 0.6rem;
    border-radius: 2px;
    text-align: right;
    display: block;
  }
  .calc-val.highlight {
    background: rgba(39,174,96,0.1);
    border-color: rgba(39,174,96,0.3);
    color: var(--jlt);
    font-weight: 600;
  }
  .calc-val.warning {
    background: rgba(231,76,60,0.1);
    border-color: rgba(231,76,60,0.3);
    color: var(--consumer);
  }

  /* ‚îÄ‚îÄ SUMMARY CARDS ‚îÄ‚îÄ */
  .summary-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    margin-bottom: 1.5rem;
  }
  .summary-card {
    background: var(--bg3);
    border-radius: 4px;
    padding: 1.25rem;
    border: 1px solid var(--border);
    position: relative;
    overflow: hidden;
  }
  .summary-card::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
  }
  .summary-card.rugged::before  { background: var(--rugged); }
  .summary-card.semi::before    { background: var(--semi); }
  .summary-card.consumer::before{ background: var(--consumer); }
  .summary-card.jlt::before     { background: var(--jlt); }
  .card-device {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.75rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 0.75rem;
  }
  .card-device.rugged  { color: var(--rugged); }
  .card-device.semi    { color: var(--semi); }
  .card-device.consumer{ color: var(--consumer); }
  .card-device.jlt     { color: var(--jlt); }
  .card-main {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 2rem;
    line-height: 1;
    margin-bottom: 0.25rem;
    color: var(--text);
  }
  .card-sub {
    font-size: 0.75rem;
    color: var(--text-dim);
    margin-bottom: 1rem;
  }
  .card-breakdown {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
  }
  .card-line {
    display: flex;
    justify-content: space-between;
    font-size: 0.78rem;
    color: var(--text-dim);
  }
  .card-line .val { color: var(--text); font-family: 'JetBrains Mono', monospace; font-size: 0.76rem; }
  .savings-badge {
    display: inline-block;
    margin-top: 0.75rem;
    background: rgba(39,174,96,0.15);
    border: 1px solid rgba(39,174,96,0.3);
    color: var(--jlt);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    border-radius: 2px;
  }
  .loss-badge {
    display: inline-block;
    margin-top: 0.75rem;
    background: rgba(231,76,60,0.12);
    border: 1px solid rgba(231,76,60,0.3);
    color: var(--consumer);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    padding: 0.2rem 0.5rem;
    border-radius: 2px;
  }

  /* ‚îÄ‚îÄ CHARTS ‚îÄ‚îÄ */
  .charts-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }
  .chart-wrap {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 1.25rem;
  }
  .chart-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.85rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text-dim);
    margin-bottom: 1rem;
  }
  .chart-full {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 1.25rem;
    margin-bottom: 1.5rem;
  }

  /* ‚îÄ‚îÄ COMPARISON TABLE ‚îÄ‚îÄ */
  .comparison-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.82rem;
  }
  .comparison-table th {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.6rem 1rem;
    text-align: right;
    background: var(--bg3);
    border-bottom: 1px solid var(--border);
  }
  .comparison-table th:first-child { text-align: left; }
  .comparison-table th.rugged  { color: var(--rugged); }
  .comparison-table th.semi    { color: var(--semi); }
  .comparison-table th.consumer{ color: var(--consumer); }
  .comparison-table th.jlt     { color: var(--jlt); }
  .comparison-table td {
    padding: 0.55rem 1rem;
    text-align: right;
    color: var(--text-dim);
    border-bottom: 1px solid rgba(42,47,61,0.5);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
  }
  .comparison-table td:first-child {
    text-align: left;
    font-family: 'Barlow', sans-serif;
    color: var(--text-dim);
    font-size: 0.82rem;
    font-family: monospace;
  }
  .comparison-table tr.section-row td {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.78rem;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: var(--text-muted);
    background: var(--bg3);
    padding: 0.4rem 1rem;
  }
  .comparison-table tr.total-row td {
    color: var(--text);
    font-weight: 600;
    font-size: 0.85rem;
    border-top: 1px solid var(--border);
  }
  .comparison-table tr.grand-row td {
    color: var(--amber);
    font-weight: 700;
    font-size: 0.9rem;
    border-top: 2px solid var(--border-bright);
    background: rgba(245,166,35,0.04);
  }

  /* ‚îÄ‚îÄ FOOTER / DISCLAIMER ‚îÄ‚îÄ */
  .disclaimer {
    text-align: center;
    color: var(--text-muted);
    font-size: 0.73rem;
    padding: 2rem 0;
    border-top: 1px solid var(--border);
    margin-top: 2rem;
    line-height: 1.6;
  }

  /* ‚îÄ‚îÄ GENERATE BTN ‚îÄ‚îÄ */
  .btn-generate {
    display: block;
    width: 100%;
    padding: 1rem;
    background: var(--amber);
    color: var(--bg);
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 800;
    font-size: 1rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    margin: 1.5rem 0;
    transition: opacity 0.2s, transform 0.1s;
  }
  .btn-generate:hover { opacity: 0.9; }
  .btn-generate:active { transform: scale(0.99); }

  /* ‚îÄ‚îÄ TOOLTIP ‚îÄ‚îÄ */
  .tip {
    color: var(--text-muted);
    font-size: 0.7rem;
    margin-top: 0.2rem;
  }

  /* ‚îÄ‚îÄ WARRANTY TABLE ‚îÄ‚îÄ */
  .warranty-grid {
    display: grid;
    grid-template-columns: 1fr repeat(4, 1fr);
    gap: 0;
  }
  .wg-cell {
    padding: 0.5rem 0.75rem;
    font-size: 0.8rem;
    border-bottom: 1px solid var(--border);
  }
  .wg-cell.label { color: var(--text-dim); }
  .wg-cell.hdr {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.78rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--text);
    background: var(--bg3);
  }
  .wg-cell.yes { color: var(--green); }
  .wg-cell.no  { color: var(--red); }
  .wg-cell.neutral { color: var(--text); }

  /* ‚îÄ‚îÄ FIXED INFO (white ‚Äî not editable) ‚îÄ‚îÄ */
  .fixed-val {
    background: rgba(255,255,255,0.04);
    border: 1px solid var(--border);
    color: var(--text-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.78rem;
    padding: 0.28rem 0.5rem;
    border-radius: 2px;
    text-align: right;
    display: block;
    cursor: default;
  }

  /* ‚îÄ‚îÄ INPUT WITH PREFIX/SUFFIX ($ and %) ‚îÄ‚îÄ */
  .field-wrap {
    position: relative;
    display: flex;
    align-items: center;
  }
  .field-prefix {
    position: absolute;
    left: 0.45rem;
    color: var(--amber-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.78rem;
    pointer-events: none;
    z-index: 1;
  }
  .field-suffix {
    position: absolute;
    right: 0.45rem;
    color: var(--amber-dim);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.78rem;
    pointer-events: none;
    z-index: 1;
  }
  .field-wrap input { width: 100%; }
  .field-wrap.has-prefix input { padding-left: 1.2rem; }
  .field-wrap.has-suffix input { padding-right: 1.4rem; }
  .field-wrap.has-prefix .fixed-val { padding-left: 1.2rem; }
  .field-wrap.has-suffix .fixed-val { padding-right: 1.4rem; }

  /* ‚îÄ‚îÄ SMALLER FIELD SIZES (half) ‚îÄ‚îÄ */
  input[type="number"], input[type="text"], select {
    padding: 0.28rem 0.45rem;
    font-size: 0.78rem;
  }
  .calc-val, .fixed-val {
    padding: 0.28rem 0.5rem;
    font-size: 0.78rem;
  }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 900px) {
    .summary-grid { grid-template-columns: 1fr 1fr; }
    .charts-grid { grid-template-columns: 1fr; }
    .col-headers, .input-row { grid-template-columns: 1fr repeat(4, 120px); }
  }
</style>
</head>
<body>

<header>
  <div class="logo">JLT <span>Mobile Computers</span></div>
  <div style="display:flex;align-items:center;gap:1rem;">
    <div class="header-badge">TCO CALCULATOR 2026</div>
    <div class="header-badge">Warehouse &amp; Manufacturing</div>
  </div>
</header>

<div class="page">
  <p class="subtitle">Based on VDC Research Data &nbsp;|&nbsp; <strong>Yellow fields</strong> are editable &nbsp;|&nbsp; Blue fields calculate automatically</p>
  <div class="legend-row">
    <div class="legend-item"><div class="legend-dot ld-amber"></div>Editable Input</div>
    <div class="legend-item"><div class="legend-dot ld-blue"></div>Calculated Value</div>
    <div class="legend-item"><div class="legend-dot" style="background:#444;border:1px solid #666;"></div>Fixed Info (read-only)</div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 1: FLEET BASICS ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">‚ö°</span>
      <span class="section-title">Fleet Basics &amp; Rates</span>
      <span class="section-chevron open">‚ñº</span>
    </div>
    <div class="section-body">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
        <div>
          <div class="input-row" style="grid-template-columns:1fr 120px">
            <div class="row-label">Number of Devices in Fleet</div>
            <input type="number" id="fleet_size" value="10" min="1" oninput="calculate()">
          </div>
          <div class="input-row" style="grid-template-columns:1fr 120px">
            <div class="row-label">Working Days per Year <span class="tip">(fixed)</span></div>
            <span class="fixed-val">240</span>
          </div>
        </div>
        <div>
          <div class="input-row" style="grid-template-columns:1fr 120px">
            <div class="row-label">Hourly Mobile Employee Rate<br><span class="tip">$30 base + 50% burden = $45</span></div>
            <div class="field-wrap has-prefix">
              <span class="field-prefix">$</span>
              <input type="number" id="worker_rate" value="45" min="0" oninput="calculate()">
            </div>
          </div>
          <div class="input-row" style="grid-template-columns:1fr 120px">
            <div class="row-label">Hourly IT Support Rate</div>
            <div class="field-wrap has-prefix">
              <span class="field-prefix">$</span>
              <input type="number" id="it_rate" value="62.5" min="0" oninput="calculate()">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 1b: LOSS OF PRODUCTIVITY / THROUGHPUT (moved here) ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">üè≠</span>
      <span class="section-title">Loss of Productivity / Throughput</span>
      <span class="section-chevron open">‚ñº</span>
    </div>
    <div class="section-body">
      <p style="font-size:0.78rem;color:var(--text-dim);margin-bottom:0.75rem;">Models the real financial impact of device downtime using warehouse throughput. Each device independently generates per-device revenue. When one device is down, productivity is reduced (not lost ‚Äî work continues via manual process but takes longer).</p>
      <!-- Single grid, explicit row placement ‚Äî labels row 1, inputs row 2, guaranteed alignment -->
      <div style="display:grid;grid-template-columns:repeat(3,1fr);grid-template-rows:auto auto;column-gap:2rem;row-gap:0.3rem;margin-bottom:0.75rem;">
        <div class="row-label" style="grid-column:1;grid-row:1;">Per-Device Revenue / Throughput Per Hour</div>
        <div class="row-label" style="grid-column:2;grid-row:1;">Productivity Reduction During Downtime<br><span class="tip">Work continues via manual process</span></div>
        <div class="row-label" style="grid-column:3;grid-row:1;">Workers Affected When Device Down</div>

        <div style="grid-column:1;grid-row:2;">
          <div class="field-wrap has-prefix">
            <span class="field-prefix">$</span>
            <input type="number" id="throughput" value="2000" oninput="calculate()" style="width:100%">
          </div>
          <div class="tip" style="margin-top:0.2rem;">E.g. $250K warehouse / 50 forklifts √ó shifts</div>
        </div>
        <div style="grid-column:2;grid-row:2;">
          <div class="field-wrap has-suffix">
            <span class="field-suffix">%</span>
            <input type="number" id="prod_loss" value="25" step="1" min="0" max="100" oninput="calculate()" style="width:100%">
          </div>
        </div>
        <div style="grid-column:3;grid-row:2;">
          <input type="number" id="workers" value="1" min="1" oninput="calculate()" style="width:100%;display:block;">
          <div class="tip" style="margin-top:0.2rem;">Operator + downstream: Pickers, Packers</div>
        </div>
      </div>
      <!-- Row 2: 2 fixed fields -->
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1.5rem;">
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;">Shifts Per Day <span class="tip">(fixed)</span></div>
          <span class="fixed-val" style="max-width:80px;display:block;">1</span>
        </div>
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;">Hours Per Shift <span class="tip">(fixed)</span></div>
          <span class="fixed-val" style="max-width:80px;display:block;">8</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 2: DEVICE COSTS ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">üí∞</span>
      <span class="section-title">Hard Costs ‚Äî Device Pricing &amp; Maintenance</span>
      <span class="section-chevron open">‚ñº</span>
    </div>
    <div class="section-body">
      <div class="col-headers">
        <div></div>
        <div class="col-hdr rugged">Rugged</div>
        <div class="col-hdr semi">Semi-Rugged</div>
        <div class="col-hdr consumer">Consumer</div>
        <div class="col-hdr jlt">JLT Rugged</div>
      </div>

      <div class="input-row">
        <div class="row-label">Device Purchase Price</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="price_r" value="3200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="price_s" value="2200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="price_c" value="800" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="price_j" value="3100" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Software / MDM Licensing (Annual)<br><span class="tip">Applied year 1 only</span></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="mdm_r" value="450" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="mdm_s" value="400" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="mdm_c" value="450" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="mdm_j" value="450" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Deployment / IT Setup Cost (One-Time)</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="setup_r" value="350" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="setup_s" value="350" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="setup_c" value="250" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="setup_j" value="300" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Annual Maintenance / Service Contract</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="maint_r" value="350" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="maint_s" value="450" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="maint_c" value="400" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="maint_j" value="300" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Annual Extended Warranty<br><span class="tip">JLT: 3-yr comprehensive included ($0). Rugged/Semi: starts yr 2. Consumer: N/A.</span></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="ewrr_r" value="105" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="ewrr_s" value="200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="ewrr_c" value="0" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="ewrr_j" value="0" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">OS Update / Migration Cost (5-yr total)<br><span class="tip">Windows Pro: ~$600√ó2 updates. Android: variable. JLT/IoT: $0 optional 10yr lifecycle.</span></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="os_r" value="1200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="os_s" value="1200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="os_c" value="600" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="os_j" value="0" oninput="calculate()"></div>
      </div>

      <div class="input-row separator" style="margin-top:0.75rem;">
        <div class="row-label" style="font-weight:600;color:var(--text);">First Year Deployment Cost (per unit) ‚Äî CALCULATED</div>
        <span class="calc-val" id="d_yr1_r">‚Äî</span>
        <span class="calc-val" id="d_yr1_s">‚Äî</span>
        <span class="calc-val" id="d_yr1_c">‚Äî</span>
        <span class="calc-val" id="d_yr1_j">‚Äî</span>
      </div>
      <div class="input-row">
        <div class="row-label" style="font-weight:600;color:var(--text);">5-Year Hard Cost Total (per unit) ‚Äî CALCULATED</div>
        <span class="calc-val" id="d_5yr_r">‚Äî</span>
        <span class="calc-val" id="d_5yr_s">‚Äî</span>
        <span class="calc-val" id="d_5yr_c">‚Äî</span>
        <span class="calc-val" id="d_5yr_j">‚Äî</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 3: ACCESSORIES ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">üîß</span>
      <span class="section-title">Accessories &amp; Add-Ons</span>
      <span class="section-chevron open">‚ñº</span>
    </div>
    <div class="section-body">
      <p style="font-size:0.8rem;color:var(--text-dim);margin-bottom:1rem;">Select YES/NO to include accessory. Edit cost per unit directly. Accessories are one-time Year 1 cost.</p>
      <div class="col-headers">
        <div></div>
        <div class="col-hdr rugged">Rugged</div>
        <div class="col-hdr semi">Semi-Rugged</div>
        <div class="col-hdr consumer">Consumer</div>
        <div class="col-hdr jlt">JLT Rugged</div>
      </div>

      <!-- Mounting Hardware -->
      <div class="input-row">
        <div class="row-label">Mounting Hardware (Forklift/Vehicle) ‚Äî Include?</div>
        <select id="acc1_inc_r" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc1_inc_s" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc1_inc_c" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc1_inc_j" onchange="calculate()"><option>YES</option><option>NO</option></select>
      </div>
      <div class="input-row">
        <div class="row-label" style="padding-left:1.5rem;">‚îî‚îÄ Cost per unit</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc1_r" value="350" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc1_s" value="350" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc1_c" value="250" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc1_j" value="400" oninput="calculate()"></div>
      </div>

      <!-- Power Supply -->
      <div class="input-row separator">
        <div class="row-label">Power Supply / Charging (Forklift Connected) ‚Äî Include?</div>
        <select id="acc2_inc_r" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc2_inc_s" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc2_inc_c" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc2_inc_j" onchange="calculate()"><option>YES</option><option>NO</option></select>
      </div>
      <div class="input-row">
        <div class="row-label" style="padding-left:1.5rem;">‚îî‚îÄ Cost per unit</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc2_r" value="280" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc2_s" value="280" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc2_c" value="200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc2_j" value="320" oninput="calculate()"></div>
      </div>

      <!-- Bluetooth Scanner -->
      <div class="input-row separator">
        <div class="row-label">Bluetooth Scanner / Barcode Reader ‚Äî Include?</div>
        <select id="acc3_inc_r" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc3_inc_s" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc3_inc_c" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc3_inc_j" onchange="calculate()"><option>YES</option><option>NO</option></select>
      </div>
      <div class="input-row">
        <div class="row-label" style="padding-left:1.5rem;">‚îî‚îÄ Cost per unit</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc3_r" value="450" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc3_s" value="450" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc3_c" value="200" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc3_j" value="450" oninput="calculate()"></div>
      </div>

      <!-- External Antenna -->
      <div class="input-row separator">
        <div class="row-label">External Antenna (WiFi/WWAN) ‚Äî Include?</div>
        <select id="acc4_inc_r" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc4_inc_s" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc4_inc_c" onchange="calculate()"><option>YES</option><option>NO</option></select>
        <select id="acc4_inc_j" onchange="calculate()"><option>YES</option><option>NO</option></select>
      </div>
      <div class="input-row">
        <div class="row-label" style="padding-left:1.5rem;">‚îî‚îÄ Cost per unit</div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc4_r" value="175" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc4_s" value="175" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc4_c" value="45" oninput="calculate()"></div>
        <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="acc4_j" value="200" oninput="calculate()"></div>
      </div>

      <div class="input-row separator">
        <div class="row-label" style="font-weight:600;color:var(--text);">Total Selected Accessories (Per Unit) ‚Äî CALCULATED</div>
        <span class="calc-val" id="acc_total_r">‚Äî</span>
        <span class="calc-val" id="acc_total_s">‚Äî</span>
        <span class="calc-val" id="acc_total_c">‚Äî</span>
        <span class="calc-val" id="acc_total_j">‚Äî</span>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 4: SOFT COSTS / FAILURE RATES ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">‚öôÔ∏è</span>
      <span class="section-title">Soft Costs ‚Äî Hardware Failure &amp; Downtime</span>
      <span class="section-chevron open">‚ñº</span>
    </div>
    <div class="section-body">
      <div class="col-headers">
        <div></div>
        <div class="col-hdr rugged">Rugged</div>
        <div class="col-hdr semi">Semi-Rugged</div>
        <div class="col-hdr consumer">Consumer</div>
        <div class="col-hdr jlt">JLT Rugged</div>
      </div>

      <div class="input-row">
        <div class="row-label">Annual Failure Rate (% of fleet ‚Äî all incident types)<br><span class="tip">VDC Research baseline: Rugged 10% | Semi 15% | Consumer 22% | JLT 5%</span></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="fail_r" value="10" step="0.1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="fail_s" value="15" step="0.1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="fail_c" value="22" step="0.1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="fail_j" value="5" step="0.1" min="0" max="100" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Incident Mix ‚Äî Small Repair (same-day service)</div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="small_r" value="70" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="small_s" value="65" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="small_c" value="55" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="small_j" value="70" step="1" min="0" max="100" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Incident Mix ‚Äî Average Repair (48hr)</div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="avg_r" value="20" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="avg_s" value="25" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="avg_c" value="25" step="1" min="0" max="100" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="avg_j" value="20" step="1" min="0" max="100" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Incident Mix ‚Äî Broken/Abuse % ‚Äî AUTO CALCULATED<br><span class="tip">= 100% ‚àí Small% ‚àí Average%</span></div>
        <span class="calc-val" id="broken_r">‚Äî</span>
        <span class="calc-val" id="broken_s">‚Äî</span>
        <span class="calc-val" id="broken_c">‚Äî</span>
        <span class="calc-val" id="broken_j">‚Äî</span>
      </div>

      <p style="font-size:0.8rem;color:var(--text-dim);margin:1rem 0 0.5rem;font-family:'Barlow Condensed',sans-serif;font-weight:600;letter-spacing:0.05em;text-transform:uppercase;">‚è± Downtime Durations ‚Äî Shared Across All Device Types</p>
      <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:1.5rem;align-items:end;margin-bottom:0.75rem;">
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;min-height:2.4rem;display:flex;align-items:flex-end;">Small Repair<br>(hours)</div>
          <input type="number" id="dt_small" value="3" min="0" oninput="calculate()" style="width:100%">
        </div>
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;min-height:2.4rem;display:flex;align-items:flex-end;">Average Repair<br>(hours)</div>
          <input type="number" id="dt_avg" value="8" min="0" oninput="calculate()" style="width:100%">
        </div>
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;min-height:2.4rem;display:flex;align-items:flex-end;">Broken/Abuse<br>(hours) <span class="tip">3-wk=120</span></div>
          <input type="number" id="dt_broken" value="120" min="0" oninput="calculate()" style="width:100%">
        </div>
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;min-height:2.4rem;display:flex;align-items:flex-end;">Tech Time Per<br>Incident (hrs)</div>
          <input type="number" id="tech_hrs" value="1.25" step="0.25" min="0" oninput="calculate()" style="width:100%">
        </div>
        <div>
          <div class="row-label" style="margin-bottom:0.3rem;min-height:2.4rem;display:flex;align-items:flex-end;">Repair Cost Per<br>Incident <span class="tip">JLT yrs1-3=$0</span></div>
          <div class="field-wrap has-prefix"><span class="field-prefix">$</span><input type="number" id="repair_cost" value="800" min="0" oninput="calculate()" style="width:100%;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 5: SCREEN DAMAGE ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">üì±</span>
      <span class="section-title">Screen Damage Assumptions</span>
      <span class="section-chevron">‚ñº</span>
    </div>
    <div class="section-body collapsed">
      <div class="col-headers">
        <div></div>
        <div class="col-hdr rugged">Rugged</div>
        <div class="col-hdr semi">Semi-Rugged</div>
        <div class="col-hdr consumer">Consumer</div>
        <div class="col-hdr jlt">JLT Rugged</div>
      </div>
      <div class="input-row">
        <div class="row-label">Annual Screen Damage Rate</div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="scr_r" value="5" step="0.5" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="scr_s" value="5" step="0.5" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="scr_c" value="10" step="0.5" oninput="calculate()"></div>
        <div class="field-wrap has-suffix"><span class="field-suffix">%</span><input type="number" id="scr_j" value="2" step="0.5" oninput="calculate()"></div>
      </div>
      <div class="input-row">
        <div class="row-label">Screen Break Downtime ‚Äî Worker reduced productivity until repaired (hours)</div>
        <input type="number" id="scr_dt_r" value="48" oninput="calculate()">
        <input type="number" id="scr_dt_s" value="48" oninput="calculate()">
        <input type="number" id="scr_dt_c" value="60" oninput="calculate()">
        <input type="number" id="scr_dt_j" value="48" oninput="calculate()">
      </div>
      <div class="input-row">
        <div class="row-label">IT Support Time per Screen Break Event (minutes)</div>
        <input type="number" id="scr_it_r" value="75" oninput="calculate()">
        <input type="number" id="scr_it_s" value="75" oninput="calculate()">
        <input type="number" id="scr_it_c" value="75" oninput="calculate()">
        <input type="number" id="scr_it_j" value="75" oninput="calculate()">
      </div>
      <div class="row-label note">Consumer: screen break = full device replacement (repair cost &gt; device price). JLT: yrs 1-3 warranty covers $0 repair; yrs 4-5 $800 repair applies. Rugged/Semi: screen damage captured in 5-yr hard cost (rate √ó $800 √ó yrs out of warranty).</div>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê SECTION 7: SPARE POOL ‚ïê‚ïê‚ïê -->
  <div class="section">
    <div class="section-header" onclick="toggleSection(this)">
      <span class="section-icon">üîÑ</span>
      <span class="section-title">Spare Pool Strategy</span>
      <span class="section-chevron">‚ñº</span>
    </div>
    <div class="section-body collapsed">
      <p style="font-size:0.8rem;color:var(--text-dim);margin-bottom:1rem;">Model the impact of maintaining a spare device pool. When enabled, broken/abuse incidents are handled immediately ‚Äî worker swaps to spare; broken device ships for repair. Eliminates 40-hr broken downtime.</p>
      <div class="col-headers">
        <div></div>
        <div class="col-hdr rugged">Rugged</div>
        <div class="col-hdr semi">Semi-Rugged</div>
        <div class="col-hdr consumer">Consumer</div>
        <div class="col-hdr jlt">JLT Rugged</div>
      </div>
      <div class="input-row">
        <div class="row-label">Enable Spare Pool?</div>
        <select id="sp_r" onchange="calculate()"><option>NO</option><option selected>YES</option></select>
        <select id="sp_s" onchange="calculate()"><option>NO</option><option selected>YES</option></select>
        <select id="sp_c" onchange="calculate()"><option>NO</option><option selected>YES</option></select>
        <select id="sp_j" onchange="calculate()"><option>NO</option><option selected>YES</option></select>
      </div>
      <div class="input-row">
        <div class="row-label">Spare Pool Size (auto: annual broken incidents, rounded up)</div>
        <span class="calc-val" id="sp_size_r">‚Äî</span>
        <span class="calc-val" id="sp_size_s">‚Äî</span>
        <span class="calc-val" id="sp_size_c">‚Äî</span>
        <span class="calc-val" id="sp_size_j">‚Äî</span>
      </div>
      <div class="input-row">
        <div class="row-label">Spare Pool Capital Cost (spare pool √ó device price)</div>
        <span class="calc-val" id="sp_cost_r">‚Äî</span>
        <span class="calc-val" id="sp_cost_s">‚Äî</span>
        <span class="calc-val" id="sp_cost_c">‚Äî</span>
        <span class="calc-val" id="sp_cost_j">‚Äî</span>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;grid-template-rows:auto auto;column-gap:1.5rem;row-gap:0.3rem;margin-top:1rem;">
        <div style="grid-column:1;grid-row:1;" class="row-label">Effective Broken Downtime With Spare Pool (hours)<br><span class="tip">Spreadsheet uses Small Repair time (C97=dtSmall) when SP active</span></div>
        <div style="grid-column:2;grid-row:1;" class="row-label">Ship Cost Per Broken Incident</div>
        <div style="grid-column:1;grid-row:2;">
          <input type="number" id="sp_dt" value="3" min="0" oninput="calculate()" style="width:50%">
        </div>
        <div style="grid-column:2;grid-row:2;">
          <div class="field-wrap has-prefix" style="width:50%;"><span class="field-prefix">$</span><input type="number" id="sp_ship" value="70" min="0" oninput="calculate()" style="width:100%"></div>
        </div>
      </div>
    </div>
  </div>

  <button class="btn-generate" onclick="calculate()">üîÑ RECALCULATE &amp; UPDATE RESULTS</button>

  <!-- ‚ïê‚ïê‚ïê RESULTS ‚ïê‚ïê‚ïê -->
  <div id="results-section">

    <!-- WARRANTY SUMMARY -->
    <div class="section" style="margin-bottom:1.5rem;">
      <div class="section-header" onclick="toggleSection(this)" style="cursor:pointer">
        <span class="section-icon">üìã</span>
        <span class="section-title">Warranty &amp; Device Summary</span>
        <span class="section-chevron open">‚ñº</span>
      </div>
      <div class="section-body">
        <div class="warranty-grid">
          <div class="wg-cell hdr"></div>
          <div class="wg-cell hdr" style="color:var(--rugged)">Rugged</div>
          <div class="wg-cell hdr" style="color:var(--semi)">Semi-Rugged</div>
          <div class="wg-cell hdr" style="color:var(--consumer)">Consumer</div>
          <div class="wg-cell hdr" style="color:var(--jlt)">JLT Rugged</div>

          <div class="wg-cell label">Operating System</div>
          <div class="wg-cell neutral">Windows Pro</div>
          <div class="wg-cell neutral">Windows Pro</div>
          <div class="wg-cell neutral">Android</div>
          <div class="wg-cell neutral">Windows IoT</div>

          <div class="wg-cell label">OS Lifecycle / Updates</div>
          <div class="wg-cell neutral">2yr cycle, forced</div>
          <div class="wg-cell neutral">2yr cycle, forced</div>
          <div class="wg-cell neutral">Variable</div>
          <div class="wg-cell yes">10yr lifecycle, optional</div>

          <div class="wg-cell label">Warranty Duration</div>
          <div class="wg-cell neutral">1 Year Standard</div>
          <div class="wg-cell neutral">1 Year Standard</div>
          <div class="wg-cell no">90 Days Only</div>
          <div class="wg-cell yes">3 Years Comprehensive</div>

          <div class="wg-cell label">Screen Damage Covered?</div>
          <div class="wg-cell no">No</div>
          <div class="wg-cell no">No</div>
          <div class="wg-cell no">No</div>
          <div class="wg-cell yes">Yes (Full)</div>

          <div class="wg-cell label">Warranty Included at No Cost?</div>
          <div class="wg-cell yes">Yes</div>
          <div class="wg-cell yes">Yes</div>
          <div class="wg-cell no">No (90 days)</div>
          <div class="wg-cell yes">Yes ‚Äî Full 3 Years</div>

          <div class="wg-cell label">Device Lifespan (Years)</div>
          <div class="wg-cell neutral">5</div>
          <div class="wg-cell neutral">4.2</div>
          <div class="wg-cell no">2</div>
          <div class="wg-cell yes">7</div>
        </div>
      </div>
    </div>

    <!-- SUMMARY CARDS -->
    <div class="summary-grid" id="summary-cards">
      <!-- populated by JS -->
    </div>

    <!-- CHARTS ‚Äî matching Excel output exactly -->
    <div class="chart-full">
      <div class="chart-title">Chart 1: Year 1 Purchase Cost ($)</div>
      <canvas id="chart1" height="180"></canvas>
    </div>
    <div class="chart-full">
      <div class="chart-title">Chart 2: Fleet Total Cost of Ownership ($)</div>
      <canvas id="chart2" height="180"></canvas>
    </div>
    <div class="chart-full">
      <div class="chart-title">Chart 3: 5-Year Fleet Productivity Throughput Loss ($)</div>
      <canvas id="chart3" height="180"></canvas>
    </div>

    <!-- DETAILED TABLE -->
    <div class="section">
      <div class="section-header" onclick="toggleSection(this)">
        <span class="section-icon">üìä</span>
        <span class="section-title">Detailed TCO Breakdown Table</span>
        <span class="section-chevron open">‚ñº</span>
      </div>
      <div class="section-body" style="padding:0;">
        <table class="comparison-table" id="detail-table">
          <thead>
            <tr>
              <th style="text-align:left;color:var(--text-dim);">Metric</th>
              <th class="rugged">Rugged</th>
              <th class="semi">Semi-Rugged</th>
              <th class="consumer">Consumer</th>
              <th class="jlt">JLT Rugged</th>
            </tr>
          </thead>
          <tbody id="table-body">
          </tbody>
        </table>
      </div>
    </div>

  </div><!-- /results-section -->

  <div class="disclaimer">
    Based on VDC Research industry benchmarks. Calculations are estimates for planning purposes.<br>
    Actual costs may vary based on environment, usage patterns, and vendor agreements.<br>
    JLT Mobile Computers ‚Äî TCO Calculator 2026 &nbsp;|&nbsp; <strong style="color:var(--amber)">Yellow = editable inputs &nbsp;|&nbsp; Blue = calculated values</strong>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CHART INSTANCES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let charts = {};
const DEVICE_COLORS = {
  r: '#2E75B6',   // Rugged ‚Äî blue (matches Excel)
  s: '#7030A0',   // Semi-Rugged ‚Äî purple
  c: '#C55A11',   // Consumer ‚Äî dark orange
  j: '#375623'    // JLT ‚Äî dark green
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const $  = id => document.getElementById(id);
const v  = id => parseFloat($(id).value) || 0;
const sv = id => $(id).value;
const fmt = n  => '$' + Math.round(n).toLocaleString();
const fmtK = n => '$' + (Math.round(n/100)/10).toLocaleString()+'K';

function acc(sfx) {
  const keys = [1,2,3,4];
  return keys.reduce((s,k) => {
    const inc = sv(`acc${k}_inc_${sfx}`) === 'YES';
    return s + (inc ? v(`acc${k}_${sfx}`) : 0);
  }, 0);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MAIN CALCULATION ‚Äî formulas mirror spreadsheet rows exactly
// R88=incidents(fleet), R39=hard5yr, R58-65=soft, R105-113=throughput
// R136-142=spare pool, R148-150=chart1, R160/165/166=chart2, R170/171=chart3
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function calculate() {
  const fleet      = v('fleet_size');    // C11
  const workerRate = v('worker_rate');   // C13/C82
  const itRate     = v('it_rate');       // C14/C81
  const throughput = v('throughput');    // C77
  const prodLossPct= v('prod_loss')/100; // C78
  const workers    = v('workers');       // C83
  const dtSmall    = v('dt_small');      // C97
  const dtAvg      = v('dt_avg');        // C98
  const dtBroken   = v('dt_broken');     // C99 = 120 hrs (3 weeks √ó 40hr/wk)
  const techHrs    = v('tech_hrs');      // C100
  const repairCost = v('repair_cost');   // C101

  const sfxs = ['r','s','c','j'];
  const results = {};

  sfxs.forEach(sfx => {
    const price    = v(`price_${sfx}`);   // C32
    const mdm      = v(`mdm_${sfx}`);     // C33
    const setup    = v(`setup_${sfx}`);   // C34
    const maint    = v(`maint_${sfx}`);   // C35
    const ewrr     = v(`ewrr_${sfx}`);    // C36
    const os       = v(`os_${sfx}`);      // C70
    const accessories = acc(sfx);          // C27
    const failRate = v(`fail_${sfx}`)/100; // C89 ‚Äî editable, VDC Research defaults
    const smallPct = v(`small_${sfx}`)/100;// C90
    const avgPct   = v(`avg_${sfx}`)/100;  // C91
    const brokenPct= Math.max(0, 1 - smallPct - avgPct); // C92 = 1-C90-C91
    const scrRate  = v(`scr_${sfx}`)/100;  // C50
    const scrDt    = v(`scr_dt_${sfx}`);   // C51
    const scrItMin = v(`scr_it_${sfx}`);   // C52

    // R88: Annual Incidents Fleet Total = ROUND(failRate √ó fleet, 0)
    const incidents = Math.round(failRate * fleet);

    // Update broken% display
    if ($(`broken_${sfx}`)) $(`broken_${sfx}`).textContent = (brokenPct*100).toFixed(1)+'%';

    // ‚îÄ‚îÄ R39: 5-Year Hard Cost Per Unit ‚îÄ‚îÄ
    // Rugged: C32+C27+(C50√óC101√ó5)+(C33+C35√ó4+C36√ó4)+C34
    // Semi:   D32+(0.1√óD32)+D27+(D50√óC101√ó5)+(D33+D35√ó4+D36√ó4)+D34
    // Consumer: E32+(0.3√óE32)+E27+(E50√óE32√ó5)+(E33+E35√ó5+E36√ó5)+E34
    // JLT:    F32+F27+(F50√óC101√ó2)+(F33+F35√ó2+F36√ó5)+F34
    let hard5yr;
    if      (sfx==='r') hard5yr = price + accessories + (scrRate*repairCost*5) + mdm + (maint*4) + (ewrr*4) + setup;
    else if (sfx==='s') hard5yr = price + (0.1*price) + accessories + (scrRate*repairCost*5) + mdm + (maint*4) + (ewrr*4) + setup;
    else if (sfx==='c') hard5yr = price + (0.3*price) + accessories + (scrRate*price*5) + mdm + (maint*5) + (ewrr*5) + setup;
    else                hard5yr = price + accessories + (scrRate*repairCost*2) + mdm + (maint*2) + (ewrr*5) + setup;

    // R38: First Year Hard Cost
    const yr1 = (sfx==='c')
      ? price + mdm + setup + maint + ewrr + accessories
      : price + mdm + setup + accessories;

    // ‚îÄ‚îÄ R58: Annual IT Downtime Cost per unit = incidents √ó techHrs √ó itRate / fleet ‚îÄ‚îÄ
    const annualIT = incidents * techHrs * itRate / fleet;

    // ‚îÄ‚îÄ R59: Annual Productivity per unit ‚Äî includes ALL incidents incl. broken ‚îÄ‚îÄ
    // = (incidents/fleet) √ó (small%√ódtSmall + avg%√ódtAvg + broken%√ódtBroken) √ó prodLoss% √ó workerRate
    const annualProd = (incidents/fleet) * (smallPct*dtSmall + avgPct*dtAvg + brokenPct*dtBroken) * prodLossPct * workerRate * workers;

    // ‚îÄ‚îÄ R60: Annual HW Repair/Replacement per unit ‚îÄ‚îÄ
    // Rugged/Semi: √ó(4/5), Consumer: √ó(4.75/5), JLT: √ó(2/5)
    const rf60 = sfx==='r'||sfx==='s' ? 4/5 : sfx==='c' ? 4.75/5 : 2/5;
    const annualRepair = incidents * brokenPct * repairCost / fleet * rf60;

    // ‚îÄ‚îÄ R61: Screen Break Productivity per unit ‚îÄ‚îÄ
    // = scrRate √ó scrDt √ó prodLoss% √ó workerRate; JLT = 0
    const scrProdLoss = (sfx==='j') ? 0 : scrRate * scrDt * prodLossPct * workerRate;

    // ‚îÄ‚îÄ R62: Screen Break IT Cost per unit ‚îÄ‚îÄ
    const scrItCost = scrRate * (scrItMin/60) * itRate;

    // ‚îÄ‚îÄ R65: Annual Soft Cost per unit = R58+R59+R60+R61+R62 ‚îÄ‚îÄ
    const annualSoft = annualIT + annualProd + annualRepair + scrProdLoss + scrItCost;

    // Update hard cost display fields
    if ($(`acc_total_${sfx}`)) $(`acc_total_${sfx}`).textContent = fmt(accessories);
    if ($(`d_yr1_${sfx}`))     $(`d_yr1_${sfx}`).textContent = fmt(yr1);
    if ($(`d_5yr_${sfx}`))     $(`d_5yr_${sfx}`).textContent = fmt(hard5yr);

    // ‚îÄ‚îÄ R154: Annual Recurring Hard Cost (fleet) ‚îÄ‚îÄ
    // Rugged/Semi: (maint√ó4+ewrr√ó4)/5√ófleet
    // Consumer:    (maint+ewrr)√ófleet
    // JLT:         (maint√ó2+ewrr√ó5)/5√ófleet
    let annualRecurringHard;
    if      (sfx==='r'||sfx==='s') annualRecurringHard = (maint*4+ewrr*4)/5 * fleet;
    else if (sfx==='c')             annualRecurringHard = (maint+ewrr) * fleet;
    else                            annualRecurringHard = (maint*2+ewrr*5)/5 * fleet;

    // ‚îÄ‚îÄ R105-R113: Throughput Model ‚îÄ‚îÄ
    const thrLossPerHr = throughput * prodLossPct; // R105 = C77√óC78

    // R106-R108: throughput loss by incident type
    const thrSmall  = incidents * smallPct  * dtSmall  * thrLossPerHr;
    const thrAvg    = incidents * avgPct    * dtAvg    * thrLossPerHr;
    const thrBroken = incidents * brokenPct * dtBroken * thrLossPerHr;

    // R109: tech labor = incidents √ó techHrs √ó itRate
    const thrTechLabor = incidents * techHrs * itRate;

    // R110: productivity = ONLY small+avg (NOT broken) √ó prodLoss% √ó workerRate √ó workers
    const thrProd = ((incidents*smallPct*dtSmall + incidents*avgPct*dtAvg) * workerRate * workers) * prodLossPct;

    // R111: broken repair cost. JLT √ó(2/5), others √ó1
    const rf111 = (sfx==='j') ? 2/5 : 1;
    const thrRepair = incidents * brokenPct * repairCost * rf111;

    // R113: Annual Fleet Throughput Total
    const annualThroughputFleet = thrSmall + thrAvg + thrBroken + thrTechLabor + thrProd + thrRepair;

    // ‚îÄ‚îÄ Spare Pool (R136-R142) ‚îÄ‚îÄ
    const spToggled = sv(`sp_${sfx}`) === 'YES';
    const spSize    = spToggled ? Math.ceil(incidents * brokenPct) : 0; // R136: CEILING(incidents√óbroken%,1) ‚Äî no /6
    const spCapital = spToggled ? spSize * price : 0; // R137

    // R138: broken downtime with SP = dtSmall (C97) if YES, else dtBroken (C99)
    const spBrokenDt = spToggled ? dtSmall : dtBroken;
    // R139: IT hrs with SP = 2 if YES, else techHrs
    const spItHrs = spToggled ? 2 : techHrs;
    // R140: ship cost = 70 if YES, else 0
    const spShipCost = spToggled ? 70 : 0;

    if ($(`sp_size_${sfx}`)) {
      $(`sp_size_${sfx}`).textContent = spToggled ? spSize : '‚Äî';
      $(`sp_cost_${sfx}`).textContent = spToggled ? fmt(spCapital) : '‚Äî';
    }

    // R142: Annual Throughput WITH Spare Pool
    // small + avg throughput unchanged; broken uses spBrokenDt
    // IT split: small+avg use normal techHrs, broken uses spItHrs
    // Productivity: uses spBrokenDt for broken incidents
    // Repair+ship for broken (JLT √ó2/5)
    let annualThroughputWithSP;
    if (spToggled) {
      const t_small   = incidents * smallPct  * dtSmall    * thrLossPerHr;
      const t_avg     = incidents * avgPct    * dtAvg      * thrLossPerHr;
      const t_broken  = incidents * brokenPct * spBrokenDt * thrLossPerHr;
      const it_smavg  = incidents * (smallPct+avgPct) * techHrs  * itRate;
      const it_broken = incidents * brokenPct          * spItHrs  * itRate;
      const prod_sp   = (incidents*smallPct*dtSmall + incidents*avgPct*dtAvg + incidents*brokenPct*spBrokenDt) * prodLossPct * workerRate * workers;
      const repship   = incidents * brokenPct * (repairCost + spShipCost) * rf111;
      annualThroughputWithSP = t_small + t_avg + t_broken + it_smavg + it_broken + prod_sp + repship;
    } else {
      annualThroughputWithSP = annualThroughputFleet;
    }

    // ‚îÄ‚îÄ Chart 1 data (R148-R150) ‚îÄ‚îÄ
    const unitPrice          = price;                       // R148
    const fleetPurchaseNoSP  = price * fleet;               // R149
    const fleetPurchaseWithSP= price * fleet + spCapital;   // R150

    // ‚îÄ‚îÄ Chart 2 data (R160, R165, R166) ‚îÄ‚îÄ
    // R160: Annual Fleet TCO = annualRecurringHard + annualSoft√ófleet + annualThroughputFleet
    const annualFleetTCO = annualRecurringHard + (annualSoft * fleet) + annualThroughputFleet;
    // R165: 5yr Fleet TCO no SP = hard5yr√ófleet + soft√ó5√ófleet + os√ófleet + thr√ó5
    const tco5yrFleet    = (hard5yr*fleet) + (annualSoft*5*fleet) + (os*fleet) + (annualThroughputFleet*5);
    // R166: 5yr Fleet TCO with SP = hard5yr√ófleet + soft√ó5√ófleet + os√ófleet + spCapital + thrSP√ó5
    const tco5yrWithSP   = (hard5yr*fleet) + (annualSoft*5*fleet) + (os*fleet) + spCapital + (annualThroughputWithSP*5);

    // ‚îÄ‚îÄ Chart 3 data (R170, R171) ‚îÄ‚îÄ
    const thr5yrFleet  = annualThroughputFleet   * 5; // R170
    const thr5yrWithSP = annualThroughputWithSP  * 5; // R171

    // Per-unit TCO (R125) for summary cards
    const tco5yrUnit = hard5yr + (annualSoft*5) + os + (annualThroughputFleet/fleet*5);

    results[sfx] = {
      price, accessories, mdm, setup, maint, ewrr, os,
      hard5yr, yr1,
      annualSoft, annualIT, annualProd, annualRepair, scrProdLoss, scrItCost,
      annualRecurringHard, annualFleetTCO,
      annualThroughputFleet, annualThroughputWithSP,
      tco5yrUnit, tco5yrFleet, tco5yrWithSP,
      unitPrice, fleetPurchaseNoSP, fleetPurchaseWithSP,
      thr5yrFleet, thr5yrWithSP,
      incidents, spToggled, spSize, spCapital,
      thrSmall, thrAvg, thrBroken
    };
  });

  renderSummaryCards(results, fleet);
  renderCharts(results, fleet);
  renderTable(results, fleet);
}
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SUMMARY CARDS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderSummaryCards(r, fleet) {
  const jltFleet = r.j.tco5yrFleet;
  const labels = {r:'Rugged', s:'Semi-Rugged', c:'Consumer', j:'JLT Rugged'};

  const html = ['r','s','c','j'].map(sfx => {
    const d = r[sfx];
    const diff = d.tco5yrFleet - jltFleet;
    let badge = '';
    if (sfx === 'j') {
      badge = `<div class="savings-badge">‚òÖ JLT BASELINE</div>`;
    } else if (diff > 0) {
      badge = `<div class="loss-badge">Fleet costs +${fmt(diff)} more than JLT</div>`;
    } else {
      badge = `<div class="savings-badge">JLT fleet saves ${fmt(-diff)}</div>`;
    }

    return `
    <div class="summary-card ${sfx}">
      <div class="card-device ${sfx}">${labels[sfx]}</div>
      <div class="card-main">${fmt(d.tco5yrFleet)}</div>
      <div class="card-sub">5-Year Fleet TCO (incl. throughput)</div>
      <div class="card-breakdown">
        <div class="card-line"><span>5-yr Hard Cost (per unit)</span><span class="val">${fmt(d.hard5yr)}</span></div>
        <div class="card-line"><span>5-yr Soft Cost (per unit)</span><span class="val">${fmt(d.annualSoft*5)}</span></div>
        <div class="card-line"><span>5-yr Throughput Loss (fleet)</span><span class="val">${fmt(d.thr5yrFleet)}</span></div>
        <div class="card-line"><span>Annual Incidents (fleet)</span><span class="val">${d.incidents_fleet}/yr</span></div>
      </div>
      ${badge}
    </div>`;
  }).join('');
  $('summary-cards').innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CHARTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderCharts(r, fleet) {
  // Excel chart colors per device ‚Äî consistent across all charts
  const LABELS = ['Rugged', 'Semi-Rugged', 'Consumer Device', 'JLT Rugged'];
  const SFXS   = ['r', 's', 'c', 'j'];
  const COLORS  = SFXS.map(s => DEVICE_COLORS[s]);

  // Shared chart defaults ‚Äî white labels on dark background
  const baseOpts = {
    responsive: true,
    animation: { duration: 400 },
    plugins: {
      legend: {
        labels: {
          color: '#dce3f0',
          font: { family: 'Barlow', size: 12 },
          boxWidth: 14, padding: 16
        }
      },
      tooltip: {
        backgroundColor: '#1a1e26',
        borderColor: '#3a4055',
        borderWidth: 1,
        titleColor: '#dce3f0',
        bodyColor: '#9aaac0',
        callbacks: { label: ctx => '  ' + ctx.dataset.label + ': ' + fmt(ctx.raw) }
      }
    },
    scales: {
      x: {
        ticks: { color: '#9aaac0', font: { family: 'Barlow', size: 11 } },
        grid:  { color: '#1f2530' }
      },
      y: {
        ticks: {
          color: '#9aaac0',
          font: { family: 'Barlow', size: 11 },
          callback: val => '$' + (val >= 1000 ? Math.round(val/1000)+'K' : val)
        },
        grid: { color: '#1f2530' }
      }
    }
  };

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // CHART 1: Year 1 Purchase Cost
  // Groups: Unit Purchase Price | Fleet (No Spare Pool) | Fleet (With Spare Pool)
  // Each group has 4 bars (one per device type)
  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  if (charts['chart1']) charts['chart1'].destroy();
  charts['chart1'] = new Chart($('chart1').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['Unit Purchase Price', 'Fleet Purchase (No Spare Pool)', 'Fleet Purchase (With Spare Pool)'],
      datasets: SFXS.map((sfx, i) => ({
        label: LABELS[i],
        backgroundColor: COLORS[i] + 'dd',
        borderColor: COLORS[i],
        borderWidth: 1,
        borderRadius: 2,
        data: [
          r[sfx].price,
          r[sfx].fleetPurchaseNoSP,
          r[sfx].fleetPurchaseWithSP
        ]
      }))
    },
    options: { ...baseOpts }
  });

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // CHART 2: Fleet Total Cost of Ownership
  // Groups: Annual Fleet TCO | 5-Year Fleet TCO | 5-Year Fleet TCO (With Spare Pool)
  // TCO = Hard + Soft + Throughput ‚Äî full cost picture matching Excel Chart 2
  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  if (charts['chart2']) charts['chart2'].destroy();
  charts['chart2'] = new Chart($('chart2').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['Annual Fleet TCO', '5-Year Fleet TCO', '5-Year Fleet TCO (With Spare Pool)'],
      datasets: SFXS.map((sfx, i) => ({
        label: LABELS[i],
        backgroundColor: COLORS[i] + 'dd',
        borderColor: COLORS[i],
        borderWidth: 1,
        borderRadius: 2,
        data: [
          r[sfx].annualFleetTCO,
          r[sfx].tco5yrFleet,
          r[sfx].tco5yrWithSP
        ]
      }))
    },
    options: { ...baseOpts }
  });

  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  // CHART 3: 5-Year Fleet Productivity Throughput Loss
  // Groups: 5-Yr Fleet Throughput Loss | 5-Yr Fleet Throughput Loss (With Spare Pool)
  // ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  if (charts['chart3']) charts['chart3'].destroy();
  charts['chart3'] = new Chart($('chart3').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['5-Yr Fleet Throughput Loss', '5-Yr Fleet Throughput Loss (With Spare Pool)'],
      datasets: SFXS.map((sfx, i) => ({
        label: LABELS[i],
        backgroundColor: COLORS[i] + 'dd',
        borderColor: COLORS[i],
        borderWidth: 1,
        borderRadius: 2,
        data: [
          r[sfx].thr5yrFleet,
          r[sfx].thr5yrWithSP
        ]
      }))
    },
    options: { ...baseOpts }
  });
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DETAIL TABLE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function row(label, vals, cls='') {
  return `<tr class="${cls}"><td>${label}</td>${vals.map(v=>`<td>${v}</td>`).join('')}</tr>`;
}
function secRow(label) {
  return `<tr class="section-row"><td colspan="5">${label}</td></tr>`;
}

function renderTable(r, fleet) {
  const sfxs = ['r','s','c','j'];
  const get = (sfx, key) => r[sfx][key];
  const rows = sfxs;

  let html = '';

  html += secRow('HARD COSTS (Per Unit)');
  html += row('Device Purchase Price', rows.map(s=>fmt(get(s,'price'))));
  html += row('Total Accessories (Year 1)', rows.map(s=>fmt(get(s,'accessories'))));
  html += row('MDM / Software License (Year 1)', rows.map(s=>fmt(get(s,'mdm'))));
  html += row('IT Setup (One-Time)', rows.map(s=>fmt(get(s,'setup'))));
  html += row('Maintenance Contract (√ócovered yrs)', rows.map(s=>`${fmt(get(s,'maint'))} √ó${get(s,'maintYrs')}`));
  html += row('Extended Warranty (√ócovered yrs)', rows.map(s=>`${fmt(get(s,'ewrr'))} √ó${get(s,'ewrrYrs')}`));
  html += row('EOL Replacement Cost (5yr)', rows.map(s=>fmt(get(s,'eolCost'))));
  html += row('Screen Damage Repair (Hard, 5yr)', rows.map(s=>fmt(get(s,'scrHardCost'))));
  html += row('OS Update / Migration (5yr)', rows.map(s=>fmt(get(s,'os'))));
  html += row('First Year Deployment Cost (per unit)', rows.map(s=>fmt(get(s,'yr1'))), 'total-row');
  html += row('5-Year Hard Cost Total (per unit)', rows.map(s=>fmt(get(s,'hard5yr'))), 'total-row');

  html += secRow('SOFT COSTS (Annual, Per Unit)');
  html += row('Annual IT Downtime Cost (Tech Labor)', rows.map(s=>fmt(get(s,'annualIT'))));
  html += row('Annual Productivity Reduction / Loss', rows.map(s=>fmt(get(s,'annualProd'))));
  html += row('Annual HW Repair/Replacement Cost', rows.map(s=>fmt(get(s,'annualRepair'))));
  html += row('Annual Screen Break Cost', rows.map(s=>fmt(get(s,'scrAnnual'))));
  html += row('Annual Soft Cost Total (per unit)', rows.map(s=>fmt(get(s,'annualSoft'))), 'total-row');
  html += row('5-Year Soft Cost Total (per unit)', rows.map(s=>fmt(get(s,'annualSoft')*5)), 'total-row');

  html += secRow(`THROUGHPUT COSTS (Annual, Fleet of ${fleet})`);
  html += row('Annual Incidents (Fleet)', rows.map(s=>get(s,'incidents_fleet')));
  html += row('Small Repair Throughput Loss', rows.map(s=>fmt(get(s,'thrSmall'))));
  html += row('Average Repair Throughput Loss', rows.map(s=>fmt(get(s,'thrAvg'))));
  html += row('Broken/Abuse Throughput Loss', rows.map(s=>fmt(get(s,'thrBroken'))));
  html += row('Annual Fleet Throughput Cost', rows.map(s=>fmt(get(s,'annualThroughputFleet'))), 'total-row');
  html += row('Annual Fleet Throughput Cost (w/ SP)', rows.map(s=>fmt(get(s,'annualThroughputWithSP'))), 'total-row');

  html += secRow('5-YEAR TOTAL COST OF OWNERSHIP');
  html += row('5-Year TCO Per Unit', rows.map(s=>fmt(get(s,'tco5yrUnit'))), 'total-row');
  html += row(`5-Year Fleet TCO (${fleet} units)`, rows.map(s=>fmt(get(s,'tco5yrFleet'))), 'total-row');
  html += row(`5-Year Fleet TCO (w/ Spare Pool)`, rows.map(s=>fmt(get(s,'tco5yrWithSP'))), 'total-row');
  html += row('5-Year Fleet Throughput Loss', rows.map(s=>fmt(get(s,'thr5yrFleet'))));
  html += row('5-Year Fleet Throughput Loss (w/ SP)', rows.map(s=>fmt(get(s,'thr5yrWithSP'))));

  const jltFleetTotal = r.j.tco5yrFleet;
  html += row(
    'JLT vs. Competitor ‚Äî 5-yr Fleet Savings',
    ['r','s','c','j'].map(s => {
      if (s === 'j') return '<span style="color:var(--jlt)">BASELINE</span>';
      const diff = r[s].tco5yrFleet - jltFleetTotal;
      return `<span style="color:${diff>0?'var(--jlt)':'var(--consumer)'}">JLT saves ${fmt(diff)}</span>`;
    }),
    'grand-row'
  );

  $('table-body').innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SECTION TOGGLE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function toggleSection(header) {
  const body = header.nextElementSibling;
  const chevron = header.querySelector('.section-chevron');
  body.classList.toggle('collapsed');
  chevron.classList.toggle('open');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
calculate();
</script>
</body>
</html>
